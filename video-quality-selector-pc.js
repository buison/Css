(function(_V_){var methods={res_label:function(res){return(/^\d+$/.test(res))?res+'p':res;}};_V_.ResolutionMenuItem=_V_.MenuItem.extend({call_count:0,init:function(player,options){var touchstart=false;options.label=methods.res_label(options.res);options.selected=(options.res.toString()===player.getCurrentRes().toString());_V_.MenuItem.call(this,player,options);this.resolution=options.res;this.on(['click','tap'],this.onClick);player.on('changeRes',_V_.bind(this,function(){if(this.resolution==player.getCurrentRes()){this.selected(true);}else{this.selected(false);}
this.call_count=0;}));}});_V_.ResolutionMenuItem.prototype.onClick=function(){if(this.call_count>0){return;}
this.player().changeRes(this.resolution);this.call_count++;};_V_.ResolutionTitleMenuItem=_V_.MenuItem.extend({init:function(player,options){_V_.MenuItem.call(this,player,options);this.off('click');}});_V_.ResolutionSelector=_V_.MenuButton.extend({init:function(player,options){player.availableRes=options.available_res;_V_.MenuButton.call(this,player,options);this.el().firstChild.firstChild.innerHTML=options.buttonText;}});_V_.ResolutionSelector.prototype.className='vjs-res-button';_V_.ResolutionSelector.prototype.createItems=function(){var player=this.player(),items=[],current_res;items.push(new _V_.ResolutionTitleMenuItem(player,{el:_V_.Component.prototype.createEl('li',{className:'vjs-menu-title vjs-res-menu-title',innerHTML:player.localize('Quality')})}));for(current_res in player.availableRes){if('length'==current_res){continue;}
items.push(new _V_.ResolutionMenuItem(player,{res:current_res}));}
items.sort(function(a,b){if(typeof a.resolution=='undefined'){return-1;}else{return parseInt(b.resolution)- parseInt(a.resolution);}});return items;};_V_.plugin('resolutionSelector',function(options){if(!this.el().firstChild.canPlayType){return;}
var player=this,sources=player.options().sources,i=sources.length,j,found_type,settings=_V_.util.mergeOptions({default_res:'',force_types:false},options||{}),available_res={length:0},current_res,resolutionSelector,default_resolutions=(settings.default_res&&typeof settings.default_res=='string')?settings.default_res.split(','):[];while(i>0){i--;if(!sources[i]['data-res']){continue;}
current_res=sources[i]['data-res'];if(typeof available_res[current_res]!=='object'){available_res[current_res]=[];available_res.length++;}
available_res[current_res].push(sources[i]);}
if(settings.force_types){for(current_res in available_res){if('length'==current_res){continue;}
i=settings.force_types.length;found_types=0;while(i>0){i--;j=available_res[current_res].length;while(j>0){j--;if(settings.force_types[i]===available_res[current_res][j].type){found_types++;break;}}}
if(found_types<settings.force_types.length){delete available_res[current_res];available_res.length--;}}}
if(available_res.length<2){return;}
for(i=0;i<default_resolutions.length;i++){if(available_res[default_resolutions[i]]){player.src(available_res[default_resolutions[i]]);player.currentRes=default_resolutions[i];break;}}
if(typeof player.localize!=='function'){player.localize=function(string){return string;};}
player.getCurrentRes=function(){if(typeof player.currentRes!=='undefined'){return player.currentRes;}else{try{return res=player.options().sources[0]['data-res'];}catch(e){return'';}}};player.changeRes=function(target_resolution){var video_el=player.el().firstChild,is_paused=player.paused(),current_time=player.currentTime(),button_nodes,button_node_count;if(player.getCurrentRes()==target_resolution||!player.availableRes||!player.availableRes[target_resolution]){return;}
if('none'==video_el.preload){video_el.preload='metadata';}
player.src(player.availableRes[target_resolution]).one('loadedmetadata',function(){player.currentTime(current_time);player.addClass('vjs-has-started');if(!is_paused){player.play();}});player.currentRes=target_resolution;if(player.controlBar.resolutionSelector){button_nodes=player.controlBar.resolutionSelector.el().firstChild.children;button_node_count=button_nodes.length;while(button_node_count>0){button_node_count--;if('vjs-control-text'==button_nodes[button_node_count].className){button_nodes[button_node_count].innerHTML=methods.res_label(target_resolution);break;}}}
player.trigger('changeRes');};current_res=player.getCurrentRes();if(current_res){current_res=methods.res_label(current_res);}
resolutionSelector=new _V_.ResolutionSelector(player,{buttonText:player.localize(current_res||'Quality'),available_res:available_res});player.controlBar.resolutionSelector=player.controlBar.addChild(resolutionSelector);});})(videojs);